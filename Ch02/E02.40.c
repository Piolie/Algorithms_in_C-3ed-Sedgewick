/* ---------------------------------------------------------------------
                              EXERCISE 2.40
------------------------------------------------------------------------
Solve the recurrence
    C_N = C_(N/2) + N^2, for N >= 2 with C_1 = 0
when N is a power of 2.
--------------------------------------------------------------------- */

/* ---------------------------------------------------------------------
N = 2^n

C_N = C_(2^n)
    = C_(2^n/2) + (2^n)^2
    = C_(2^(n-1)) + 2^(2n)
    = C_(2^(n-1)/2) + (2^(n-1))^2 + 2^(2n)
    = C_(2^(n-2)) + 2^(2(n-1)) + 2^(2n)
    = ...
    = C_(2^(n-n)) + 2^(2*1) + 2^(2*2) + ... + 2^(2(n-1)) + 2^(2n)
    = C_1 + 2^(2*1) + 2^(2*2) + ... + 2^(2(n-1)) + 2^(2n)
    =       2^(2*1) + 2^(2*2) + ... + 2^(2(n-1)) + 2^(2n)

      k=n
      ---
    = \   2^(2k)
      /
      ---
      k=1

------------------------------------------------------------------------

We would have to apply induction to formally prove it.

--------------------------------------------------------------------- */

#include <stdio.h>
#include <math.h>

unsigned C_N(unsigned N)
{
    if(N == 1)
        return 0;

    return C_N(N/2) + N*N;
}

unsigned C_2pown_formula(unsigned n)
{
    unsigned result = 0;
    for (unsigned i=1; i < n+1; i++)
        result += (unsigned)(exp2(2*i));

    return result;
}

int main(void)
{
    printf("N\tC_N (rec.)\tC_N (form.)\tEqual?\n");
    printf("----------------------------------------------\n");
    unsigned N, n;
    for (N = 1, n = 0; N < 65; n++, N = (unsigned)(exp2(n)))
    {
        unsigned CN_recurrence = C_N(N);
        unsigned CN_formula = C_2pown_formula(n);
        int equal = (CN_recurrence == CN_formula);
        printf("%u\t%u\t\t%u\t\t%d\n", N, CN_recurrence, CN_formula, equal);
    }
}

/* ---------------------------------------------------------------------
                                 OUTPUT
------------------------------------------------------------------------
N       C_N (rec.)      C_N (form.)     Equal?
----------------------------------------------
1       0               0               1
2       4               4               1
4       20              20              1
8       84              84              1
16      340             340             1
32      1364            1364            1
64      5460            5460            1

--------------------------------------------------------------------- */
