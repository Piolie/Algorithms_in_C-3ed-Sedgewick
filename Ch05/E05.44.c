/* ---------------------------------------------------------------------
                             EXERCISE 5.44
------------------------------------------------------------------------
Write a function that uses bottom-up dynamic programming to compute the
value of C_N defined by the recurrence
           1   ----
C_N = N + ---  \     (C_(k - 1) + C_(N - k)), for N >= 1 with C_0 = 0.
           N   /
               ----
              1<=k<=N
--------------------------------------------------------------------- */

/* ---------------------------------------------------------------------
C_1 = 1 + (C_(1 - 1) + C_(1 - 1))
    = 1 + C_0 + C_0
    = 1

           1   ----
C_2 = 2 + ---  \     (C_(k - 1) + C_(2 - k))
           2   /
               ----
              1<=k<=2
    = 2 + 1/2*(C_(1 - 1) + C_(2 - 1) + C_(2 - 1) + C_(2 - 2))
    = 2 + 1/2*(C_0 + C_1 + C_1 + C_0)
    = 2 + C_1
    = 3

           1   ----
C_3 = 3 + ---  \     (C_(k - 1) + C_(3 - k))
           3   /
               ----
              1<=k<=3
    = 3 + 1/3*(C_(1 - 1) + C_(3 - 1) + C_(2 - 1) +
               C_(3 - 2) + C_(3 - 1) + C_(3 - 3))
    = 3 + 1/3*(C_0 + C_2 + C_1 + C_1 + C_2 + C_0)
    = 3 + 2/3*(C_2 + C_1)
    = 3 + 2/3*(3 + 1)
    = 3 + 8/3 = 17/3 ~ 5.67
--------------------------------------------------------------------- */

#include <stdio.h>
#include <stdlib.h>

float C(unsigned int N) {
  float knownC[N + 1];
  knownC[0] = 0;

  for (unsigned int i = 1; i <= N; i++) {
    float sum = 0;
    for (unsigned int k = 1; k <= i; k++)
      sum += knownC[k - 1] + knownC[i - k];
    knownC[i] = i + 1.0 * sum / i;
  }
  return knownC[N];
}

int main(int argc, char *argv[]) {
  (void)argc;
  int N = atoi(argv[1]);
  printf("C_%d = %f\n", N, C(N));
}

/* ---------------------------------------------------------------------
                                 OUTPUT
------------------------------------------------------------------------
./E05.44.exe 20
C_20 = 91.105064

./E05.44.exe 99
C_99 = 738.475403

./E05.44.exe 1001
C_1001 = 11999.890625
--------------------------------------------------------------------- */
